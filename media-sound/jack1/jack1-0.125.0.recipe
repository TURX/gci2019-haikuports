SUMMARY="Jack Audio Connection Kit"
DESCRIPTION="An audio connection kit"
HOMEPAGE="https://jackaudio.org"
COPYRIGHT="2001-2011 Paul Davis."
LICENSE="GNU GPL v2"
REVISION="1"
srcGitRev="$portVersion"
SOURCE_URI="https://github.com/jackaudio/jack1/archive/$srcGitRev.tar.gz"
CHECKSUM_SHA256="fa2021ccb7e076881a699f17218b5a23705a0215a363e077ad8fd80bfcd76187"
SOURCE_FILENAME="$srcGitRev.tar.gz"
SOURCE_DIR="jack1-$srcGitRev"
PATCHES="jack1-$srcGitRev.patchset"
srcGitRev2="07f1ecf1ce119d861ec631cb4a6a81a1ab1e5657"
SOURCE_URI_2="https://github.com/jackaudio/headers/archive/$srcGitRev2.tar.gz"
CHECKSUM_SHA256_2="0c8c3dd69df8c295566585ab8708e2b867453b765f12dcec3f0e1b3ad24ae534"
SOURCE_FILENAME_2="$srcGitRev2.tar.gz"
srcGitRev3="02ddc6ea2f16e41326c675b1bcfcd6335390b88e"
SOURCE_URI_3="https://github.com/jackaudio/tools/archive/$srcGitRev3.tar.gz"
CHECKSUM_SHA256_3="062a1a1348340a51bd67ec0291ce99b857e3c768808371a813afe97037ebea7b"
SOURCE_FILENAME_3="$srcGitRev3.tar.gz"
PATCHES_3="tools-$srcGitRev3.patchset"
srcGitRev4="7fa089095c81e81dacd2554ae3184acc7f2d58ed"
SOURCE_URI_4="https://github.com/jackaudio/example-clients/archive/$srcGitRev4.tar.gz"
CHECKSUM_SHA256_4="81f971cc7a36baa17273738bb73605f24b001eac9d670b2335344832425e0dd6"
SOURCE_FILENAME_4="$srcGitRev4.tar.gz"

ARCHITECTURES="x86_64"
SECONDARY_ARCHITECTURES="x86"

PROVIDES="
	jack1$secondaryArchSuffix = $portVersion
	cmd:jack_alias
	cmd:jack_bufsize
	cmd:jack_connect
	cmd:jack_control
	cmd:jack_cpu
	cmd:jack_cpu_load
	cmd:jack_disconnect
	cmd:jack_evmon
	cmd:jack_freewheel
	cmd:jack_iodelay
	cmd:jack_latent_client
	cmd:jack_load
	cmd:jack_lsp
	cmd:jack_metro
	cmd:jack_midi_dump
	cmd:jack_midi_latency_test
	cmd:jack_midiseq
	cmd:jack_midisine
	cmd:jack_monitor_client
	cmd:jack_multiple_metro
	cmd:jack_net_master
	cmd:jack_net_slave
	cmd:jack_rec
	cmd:jack_samplerate
	cmd:jack_server_control
	cmd:jack_session_notify
	cmd:jack_showtime
	cmd:jack_simple_client
	cmd:jack_simple_session_client
	cmd:jack_test
	cmd:jack_thru
	cmd:jack_transport
	cmd:jack_unload
	cmd:jack_wait
	cmd:jack_zombie
	cmd:jackd
	lib:libjack$secondaryArchSuffix = 0.1.0 compat >= 0
	lib:libjacknet$secondaryArchSuffix = 0.1.0 compat >= 0
	lib:libjackserver$secondaryArchSuffix = 0.1.0 compat >= 0
	"
REQUIRES="
	haiku$secondaryArchSuffix
	lib:libdb$secondaryArchSuffix
	lib:libreadline$secondaryArchSuffix
	lib:libsamplerate$secondaryArchSuffix
	lib:libsndfile$secondaryArchSuffix
	"

PROVIDES_devel="
	jack1${secondaryArchSuffix}_devel
	devel:libjack = 0.1.0 compat >= 0
	devel:libjacknet = 0.1.0 compat >= 0
	devel:libjackserver = 0.1.0 compat >= 0
	"
REQUIRES_devel="
	jack1$secondaryArchSuffix == base
	"

BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	devel:libdb$secondaryArchSuffix
	devel:libreadline$secondaryArchSuffix
	devel:libsamplerate$secondaryArchSuffix
	devel:libsndfile$secondaryArchSuffix
	"
BUILD_PREREQUIRES="
	cmd:aclocal
	cmd:autoconf
	cmd:autoheader
	cmd:automake
	cmd:g++$secondaryArchSuffix
	cmd:git
	cmd:libtoolize
	cmd:make
	cmd:pkg_config$secondaryArchSuffix
	cmd:python
	"

BUILD()
{
	# submodules
	rm -rf jack tools
	cp -r $sourceDir2/headers-$srcGitRev2 jack
	cp -r $sourceDir3/tools-$srcGitRev3 tools
	cp -r $sourceDir4/example-clients-$srcGitRev4/* example-clients
	# building
	./autogen.sh
	runConfigure ./configure
	make $jobsArgs -j$jobs
}

INSTALL()
{
	make install -j$jobs

	mkdir -p "$includeDir"
	mv "$prefix"/include/jack/ "$includeDir"
	rmdir "$prefix"/include

	prepareInstalledDevelLibs libjack libjacknet libjackserver
	fixPkgconfig

	packageEntries devel \
		"$developDir"
}
